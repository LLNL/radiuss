---
event_type: PushEvent
avatar: "https://avatars.githubusercontent.com/u/299842?"
user: tgamblin
date: 2025-04-11
repo_name: spack/spack
html_url: https://github.com/spack/spack/commit/8fc1ccc686cdcdda71aab2d94abcfab3d99a2a89
repo_url: https://github.com/spack/spack
---

<a href='https://github.com/tgamblin' target='_blank'>tgamblin</a> pushed to <a href='https://github.com/spack/spack' target='_blank'>spack/spack</a>

<small>solver: encode `%` as "build requirement", not as "dependency" (#50011)

This PR fixes the issues with `%` and reused specs, due to https://github.com/spack/spack/issues/49847#issuecomment-2774640234 

It does so by adding another layer of indirection, so that whenever a spec
`foo %bar` is encountered, the `%bar` part is encoded as an
`attr("build_requirement", ...)`.

Then:

1. If `foo` is a node to be built, then the build requirement implies a dependency
2. Otherwise it implies looking e.g. reused specs metadata, and ensure it matches

---------

Signed-off-by: Massimiliano Culpo <massimiliano.culpo@gmail.com></small>

<a href='https://github.com/spack/spack/commit/8fc1ccc686cdcdda71aab2d94abcfab3d99a2a89' target='_blank'>View Commit</a>