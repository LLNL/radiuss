---
event_type: PushEvent
avatar: "https://avatars.githubusercontent.com/u/1659704?"
user: scheibelp
date: 2023-10-27
repo_name: spack/spack
html_url: https://github.com/spack/spack/commit/148dce96edaee62889a17579dc373afbd080e498
repo_url: https://github.com/spack/spack
---

<a href='https://github.com/scheibelp' target='_blank'>scheibelp</a> pushed to <a href='https://github.com/spack/spack' target='_blank'>spack/spack</a>

<small>MSVC: detection from registry (#38500)

Typically MSVC is detected via the VSWhere program. However, this may
not be available, or may be installed in an unpredictable location.
This PR adds an additional approach via Windows Registry queries to
determine VS install location root.

Additionally:

* Construct vs_install_paths after class-definition time (move it to
  variable-access time).
* Skip over keys for which a user does not have read permissions
  when performing searches (previously the presence of these keys
  would have caused an error, regardless of whether they were
  needed).
* Extend helper functionality with option for regex matching on
  registry keys vs. exact string matching.
* Some internal refactoring: remove boolean parameters in some cases
  where the function was always called with the same value
  (e.g. `find_subkey`)</small>

<a href='https://github.com/spack/spack/commit/148dce96edaee62889a17579dc373afbd080e498' target='_blank'>View Commit</a>