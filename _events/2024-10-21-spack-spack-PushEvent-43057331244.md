---
event_type: PushEvent
avatar: "https://avatars.githubusercontent.com/u/660149?"
user: trws
date: 2024-10-21
repo_name: spack/spack
html_url: https://github.com/spack/spack/commit/a07d42d35bacf721616b45466ce1227c47cb1618
repo_url: https://github.com/spack/spack
---

<a href='https://github.com/trws' target='_blank'>trws</a> pushed to <a href='https://github.com/spack/spack' target='_blank'>spack/spack</a>

<small>Devtools darwin (#46910)

* stacks: add a stack for devtools on darwin

After getting this whole mess building on darwin, let's keep it that
way, and maybe make it so we have some non-ML darwin binaries in spack
as well.

* reuse: false for devtools

* dtc: fix darwin dylib name and id

On mac the convention is `lib<name>.<num>.dylib`, while the makefile
creates a num suffixed one by default. The id in the file is also a
local name rather than rewritten to the full path, this fixes both
problems.

* node-js: make whereis more deterministic

* relocation(darwin): catch Mach-O load failure

The MachO library can throw an exception rather than return no headers,
this happened in an elf file in the test data of go-bootstrap.  Trying
catching the exception and moving on for now.  May also need to look
into why we're trying to rewrite an elf file.

* qemu: add darwin flags to clear out warnings

There's a build failure for qemu in CI, but it's invisible because of
the immense mass of warning output.  Explicitly specify the target macos
version and remove the extraneous unknown-warning-option flag.

* dtc: libyaml is also a link dependency

libyaml is required at runtime to run the dtc binary, lack of it caused
the ci for qemu to fail when the library wasn't found.</small>

<a href='https://github.com/spack/spack/commit/a07d42d35bacf721616b45466ce1227c47cb1618' target='_blank'>View Commit</a>