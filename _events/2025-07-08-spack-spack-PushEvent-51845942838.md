---
event_type: PushEvent
avatar: "https://avatars.githubusercontent.com/u/299842?"
user: tgamblin
date: 2025-07-08
repo_name: spack/spack
html_url: https://github.com/spack/spack/commit/dcc8561c7c398cd1ab87b27950c1a9b29eb28df0
repo_url: https://github.com/spack/spack
---

<a href='https://github.com/tgamblin' target='_blank'>tgamblin</a> pushed to <a href='https://github.com/spack/spack' target='_blank'>spack/spack</a>

<small>find: report in groups by compilers (not compiler) (#50909)

In the spirit of recent compiler changes, it might be helpful to start grouping
installed packages by `compilers` instead of `compiler`. This PR changes the
output, which seems fine for a "fresh" clone/installs BUT not so nice for a clone
whose database was converted from `v7` to `v8` and references packages
that are no longer installed.

### [RE]FRESH[ED] INSTALLS

```
$ spack find -If
-- darwin-sequoia-m1 / apple-clang@17.0.0 -----------------------
[+]  libelf@0.8.13  [+]  zlib@1.3.1

-- darwin-sequoia-m1 / no compiler ------------------------------
[e]  apple-clang@17.0.0  [e]  git@2.39.5    [e]  openssh@9.9p2
[e]  bison@2.3           [e]  gmake@3.81    [e]  perl@5.34.1
[e]  curl@8.7.1          [e]  m4@1.4.6      [e]  pkgconf@2.4.3
[e]  flex@2.6.4          [e]  meson@1.8.2   [e]  python@3.13.5
[e]  gettext@0.25        [e]  ninja@1.12.1
==> 16 installed package
```

to:

```
$ spack find -If
-- darwin-sequoia-m1 / %c,cxx=apple-clang@17.0.0 ----------------
[+]  zlib@1.3.1

-- darwin-sequoia-m1 / %c=apple-clang@17.0.0 --------------------
[+]  libelf@0.8.13

-- darwin-sequoia-m1 / no compilers -----------------------------
[e]  apple-clang@17.0.0  [e]  git@2.39.5    [e]  openssh@9.9p2
[e]  bison@2.3           [e]  gmake@3.81    [e]  perl@5.34.1
[e]  curl@8.7.1          [e]  m4@1.4.6      [e]  pkgconf@2.4.3
[e]  flex@2.6.4          [e]  meson@1.8.2   [e]  python@3.13.5
[e]  gettext@0.25        [e]  ninja@1.12.1
==> 16 installed packages
```

### "MIXED" INSTALLS

In this case, `find` doesn't necessarily have the information it needs to
properly group the installed software by `compilers` plus is likely relying
on a database that references packages that are no longer installed (after
say a conversion from `v7` to `v8` schema).

From:

```
$ spack find -If
-- linux-rhel8-broadwell / gcc@12.1.1 ---------------------------
[+]  bzip2@1.0.8     [+]  gmake@4.4.1    [+]  pigz@2.8       [+]  zstd@1.5.7
[+]  bzip2@1.0.8     [+]  gmake@4.4.1    [+]  tar@1.35
[+]  diffutils@3.10  [+]  libiconv@1.18  [+]  xz@5.6.3
[+]  diffutils@3.10  [+]  libiconv@1.18  [+]  zlib-ng@2.2.4

-- linux-rhel8-broadwell / no compiler --------------------------
[+]  compiler-wrapper@1.0  [e]  gcc@11.3.0          [+]  gcc-runtime@12.1.1
[e]  gcc@10.3.1            [e]  gcc@12.1.1
[e]  gcc@11.2.1            [+]  gcc-runtime@12.1.1

-- linux-rhel8-x86_64_v3 / gcc@12.1.1 ---------------------------
[e]  glibc@2.28  [e]  openssl@1.1.1k  [e]  python@3.9.13  [e]  zlib@1.2.11

-- linux-rhel8-x86_64_v3 / gcc@10.3.1 ---------------------------
[e]  glibc@2.28  [e]  python@3.10.12

-- linux-rhel8-x86_64_v3 / gcc@11.2.1 ---------------------------
[e]  openssl@1.1.1k  [e]  zlib@1.2.11

-- linux-rhel8-x86_64_v3 / gcc@11.3.0 ---------------------------
[e]  glibc@2.28
==> 29 installed packages
```

to

```
$spack find -If 
-- linux-rhel8-broadwell / %c,cxx=gcc@12.1.1 --------------------
[+]  zlib-ng@2.2.4  [+]  zstd@1.5.7

-- linux-rhel8-broadwell / %c=gcc@12.1.1 ------------------------
[+]  bzip2@1.0.8     [+]  diffutils@3.10  [+]  libiconv@1.18  [+]  tar@1.35
[+]  bzip2@1.0.8     [+]  gmake@4.4.1     [+]  libiconv@1.18  [+]  xz@5.6.3
[+]  diffutils@3.10  [+]  gmake@4.4.1     [+]  pigz@2.8

-- linux-rhel8-broadwell / no compilers -------------------------
[+]  compiler-wrapper@1.0  [e]  gcc@11.3.0          [+]  gcc-runtime@12.1.1
[e]  gcc@10.3.1            [e]  gcc@12.1.1
[e]  gcc@11.2.1            [+]  gcc-runtime@12.1.1

-- linux-rhel8-x86_64_v3 / no compilers -------------------------
[e]  glibc@2.28  [e]  openssl@1.1.1k  [e]  python@3.10.12
[e]  glibc@2.28  [e]  openssl@1.1.1k  [e]  zlib@1.2.11
[e]  glibc@2.28  [e]  python@3.9.13   [e]  zlib@1.2.11
==> 29 installed packages
```

---------

Signed-off-by: Tamara Dahlgren <35777542+tldahlgren@users.noreply.github.com></small>

<a href='https://github.com/spack/spack/commit/dcc8561c7c398cd1ab87b27950c1a9b29eb28df0' target='_blank'>View Commit</a>