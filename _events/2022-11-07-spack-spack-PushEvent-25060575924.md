---
event_type: PushEvent
avatar: "https://avatars.githubusercontent.com/u/299842?"
user: tgamblin
date: 2022-11-07
repo_name: spack/spack
html_url: https://github.com/spack/spack/commit/4b84cd8af5195c44341c4cecd1dc061ed1790909
repo_url: https://github.com/spack/spack
---

<a href='https://github.com/tgamblin' target='_blank'>tgamblin</a> pushed to <a href='https://github.com/spack/spack' target='_blank'>spack/spack</a>

<small>bugfix for matrices with dependencies by hash (#22991)

Dependencies specified by hash are unique in Spack in that the abstract
specs are created with internal structure. In this case, the constraint
generation for spec matrices fails due to flattening the structure.

It turns out that the dep_difference method for Spec.constrain does not
need to operate on transitive deps to ensure correctness. Removing transitive
deps from this method resolves the bug.

- [x] Includes regression test</small>

<a href='https://github.com/spack/spack/commit/4b84cd8af5195c44341c4cecd1dc061ed1790909' target='_blank'>View Commit</a>